{"ast":null,"code":"import _slicedToArray from\"/Users/rafaelbrigati/Desktop/aqua-pet-shop-client2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,createContext}from\"react\";// import axios from \"axios\";\nimport authMethods from\"../services/auth.service\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext();function AuthProviderWrapper(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoggedIn=_useState2[0],setIsLoggedIn=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var storeToken=function storeToken(token){//  <==  ADD\nlocalStorage.setItem('authToken',token);};var authenticateUser=function authenticateUser(){//  <==  ADD  \n// Get the stored token from the localStorage\nvar storedToken=localStorage.getItem('authToken');// If the token exists in the localStorage\nif(storedToken){// We must send the JWT token in the request's \"Authorization\" Headers\nauthMethods.verifyToken(storedToken).then(function(userPayload){// Update state variables        \nsetIsLoggedIn(true);setIsLoading(false);setUser(userPayload);}).catch(function(error){// If the server sends an error response (invalid token) \n// Update state variables         \nsetIsLoggedIn(false);setIsLoading(false);setUser(null);});}else{// If the token is not available (or is removed)\nsetIsLoggedIn(false);setIsLoading(false);setUser(null);}};var removeToken=function removeToken(){// <== ADD\n// Upon logout, remove the token from the localStorage\nlocalStorage.removeItem(\"authToken\");};var logOutUser=function logOutUser(){// <== ADD    \n// To log out the user, remove the token\nremoveToken();// and update the state variables    \nauthenticateUser();};useEffect(function(){authenticateUser();//  <==  ADD\n},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{isLoggedIn:isLoggedIn,isLoading:isLoading,user:user,setUser:setUser,storeToken:storeToken,authenticateUser:authenticateUser,logOutUser:logOutUser},children:props.children});}export{AuthProviderWrapper,AuthContext};","map":{"version":3,"names":["React","useState","useEffect","createContext","authMethods","jsx","_jsx","AuthContext","AuthProviderWrapper","props","_useState","_useState2","_slicedToArray","isLoggedIn","setIsLoggedIn","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","user","setUser","storeToken","token","localStorage","setItem","authenticateUser","storedToken","getItem","verifyToken","then","userPayload","catch","error","removeToken","removeItem","logOutUser","Provider","value","children"],"sources":["/Users/rafaelbrigati/Desktop/aqua-pet-shop-client2/src/context/auth.context.js"],"sourcesContent":["import React, { useState, useEffect, createContext } from \"react\";\n// import axios from \"axios\";\nimport authMethods from \"../services/auth.service\";\n \nconst AuthContext = createContext();\n \nfunction AuthProviderWrapper(props) {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [user, setUser] = useState(null);\n  \n  const storeToken = (token) => {       //  <==  ADD\n    localStorage.setItem('authToken', token);\n  }\n\n  const authenticateUser = () => {           //  <==  ADD  \n    // Get the stored token from the localStorage\n    const storedToken = localStorage.getItem('authToken');\n    \n    // If the token exists in the localStorage\n    if (storedToken) {\n      // We must send the JWT token in the request's \"Authorization\" Headers\n      authMethods.verifyToken(storedToken)\n      .then((userPayload) => {\n      \n       // Update state variables        \n        setIsLoggedIn(true);\n        setIsLoading(false);\n        setUser(userPayload);        \n      })\n      .catch((error) => {\n        // If the server sends an error response (invalid token) \n        // Update state variables         \n        setIsLoggedIn(false);\n        setIsLoading(false);\n        setUser(null);        \n      });      \n    } else {\n      // If the token is not available (or is removed)\n        setIsLoggedIn(false);\n        setIsLoading(false);\n        setUser(null);      \n    }   \n  }\n\n  const removeToken = () => {                    // <== ADD\n    // Upon logout, remove the token from the localStorage\n    localStorage.removeItem(\"authToken\");\n  }\n \n \n  const logOutUser = () => {                   // <== ADD    \n    // To log out the user, remove the token\n    removeToken();\n    // and update the state variables    \n    authenticateUser();\n  }  \n \n  \n  useEffect(() => {                                    \n    authenticateUser();                   //  <==  ADD\n   }, []);\n\n  return (\n    <AuthContext.Provider value={{ isLoggedIn, isLoading, user, setUser, storeToken, authenticateUser, logOutUser }}>\n      {props.children}\n    </AuthContext.Provider>\n  )\n}\n \nexport { AuthProviderWrapper, AuthContext };"],"mappings":"wIAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,aAAa,KAAQ,OAAO,CACjE;AACA,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEnD,GAAM,CAAAC,WAAW,cAAGJ,aAAa,CAAC,CAAC,CAEnC,QAAS,CAAAK,mBAAmBA,CAACC,KAAK,CAAE,CAClC,IAAAC,SAAA,CAAoCT,QAAQ,CAAC,KAAK,CAAC,CAAAU,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA5CG,UAAU,CAAAF,UAAA,IAAEG,aAAa,CAAAH,UAAA,IAChC,IAAAI,UAAA,CAAkCd,QAAQ,CAAC,IAAI,CAAC,CAAAe,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B,IAAAG,UAAA,CAAwBlB,QAAQ,CAAC,IAAI,CAAC,CAAAmB,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAA/BE,IAAI,CAAAD,UAAA,IAAEE,OAAO,CAAAF,UAAA,IAEpB,GAAM,CAAAG,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,KAAK,CAAK,CAAQ;AACpCC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEF,KAAK,CAAC,CAC1C,CAAC,CAED,GAAM,CAAAG,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAAY;AACzC;AACA,GAAM,CAAAC,WAAW,CAAGH,YAAY,CAACI,OAAO,CAAC,WAAW,CAAC,CAErD;AACA,GAAID,WAAW,CAAE,CACf;AACAxB,WAAW,CAAC0B,WAAW,CAACF,WAAW,CAAC,CACnCG,IAAI,CAAC,SAACC,WAAW,CAAK,CAEtB;AACClB,aAAa,CAAC,IAAI,CAAC,CACnBI,YAAY,CAAC,KAAK,CAAC,CACnBI,OAAO,CAACU,WAAW,CAAC,CACtB,CAAC,CAAC,CACDC,KAAK,CAAC,SAACC,KAAK,CAAK,CAChB;AACA;AACApB,aAAa,CAAC,KAAK,CAAC,CACpBI,YAAY,CAAC,KAAK,CAAC,CACnBI,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAAC,CACJ,CAAC,IAAM,CACL;AACER,aAAa,CAAC,KAAK,CAAC,CACpBI,YAAY,CAAC,KAAK,CAAC,CACnBI,OAAO,CAAC,IAAI,CAAC,CACjB,CACF,CAAC,CAED,GAAM,CAAAa,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CAAqB;AAC7C;AACAV,YAAY,CAACW,UAAU,CAAC,WAAW,CAAC,CACtC,CAAC,CAGD,GAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,CAAS,CAAoB;AAC3C;AACAF,WAAW,CAAC,CAAC,CACb;AACAR,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAGDzB,SAAS,CAAC,UAAM,CACdyB,gBAAgB,CAAC,CAAC,CAAoB;AACvC,CAAC,CAAE,EAAE,CAAC,CAEP,mBACErB,IAAA,CAACC,WAAW,CAAC+B,QAAQ,EAACC,KAAK,CAAE,CAAE1B,UAAU,CAAVA,UAAU,CAAEI,SAAS,CAATA,SAAS,CAAEI,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEC,UAAU,CAAVA,UAAU,CAAEI,gBAAgB,CAAhBA,gBAAgB,CAAEU,UAAU,CAAVA,UAAW,CAAE,CAAAG,QAAA,CAC7G/B,KAAK,CAAC+B,QAAQ,CACK,CAAC,CAE3B,CAEA,OAAShC,mBAAmB,CAAED,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}